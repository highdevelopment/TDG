<!doctype html>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=1200, initial-scale=1.0, maxium-scale=1.0, minimum-scale=1.0, user-scalable=yes" />
		<meta name="format-detection" content="telephone=no" />
		<!-- Favicon -->
		<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
		<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
		<link rel="stylesheet" href="../style/css/reset.css" media="all">
		<title>더 도어스 스크린 골프 게임 설정</title>
		<!--[if lt IE 9]>
			<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js" type="text/javascript"></script>
			<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/ie7-squish.js" type="text/javascript"></script>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
		<script type="text/javascript" src="../style/js/jquery-1.11.3.min.js"></script>
		<script type="text/javascript" src="../style/js/jquery.bxslider/jquery.bxslider.min.js"></script>
		<script type="text/javascript" src="../style/js/main.js"></script>
		<script type="text/javascript" src="../style/js/Chart.min.js"></script>
	</head>
	<body>

	<!--헤더-->
	{{>header}}
	<!--헤더-->


	<!--서브탑-->
	<div class="subTop">
		<div class="subTopInner">
			<h1>게임 설정</h1>
			<div class="location">
				<a href="#">MY DOORS</a> > <span>게임 설정</span>
			</div>
		</div>
	</div>
	<!--서브탑-->

	<!--바디-->
	<article>
		<div id="bodyWrap">
		<!--내용시작-->

		<!--회원 정보-->
		<div class="settingTop wrap1200">
			<div class="wrap835">
				<figure>
					<img src={{user.photo}} alt="">
					<figcaption>{{user.nickname}} 님<span>{{user.username}}</span></figcaption>
				</figure>
				<div class="info">
					<p>{{user.nickname}} 프로님, 반갑습니다.</p>
					<ul>
						<li>
							<h3>나의 기록</h3>
							<ul>
								<li>{{user.user_bestscore}}<span>최고 스코어</span></li>
								<li>{{user.user_bestCarry}}m<span>최대 비거리</span></li>
								<li>{{user.user_bestPuttingDist}}m<span>최대 퍼팅거리</span></li>
								<li>{{user.user_averscore}}<span>평균 타수</span></li>
								<li>{{user.user_averCarry}}m<span>평균 비거리</span></li>
								<li>{{user.user_averPuttingNum}}<span>평균 퍼팅수</span></li>
							</ul>
						</li>
						<li>
							<h3>나의 경기력</h3>
							<div style="width:296px; padding-left: 33px;">
								<canvas id="chart_score"></canvas>
							</div>
							{{!-- <img src="../images/mydoors/memberGraph.png" alt="김도어 님 그래프"> --}}
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!--회원 정보-->

		<!--게임 설정 정보-->
		<div class="gameSetting wrap835">
			<dl>
				<dt>난이도</dt>
				<dd>
					<ul id="select_difficulty">
						<li><div class="">일반</div></li>
						<li><div>세미투어</div></li>
						<li><div>투어</div></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>타석 위치</dt>
				<dd>
					<ul id="select_tasekPos">
						<li><div>왼손</div></li>
						<li><div>오른손</div></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>티 위치</dt>
				<dd>
					<ul id="select_teePos">
						<li><div>Red</div></li>
						<li><div>Yellow</div></li>
						<li><div>White</div></li>
						<li><div>Blue</div></li>
						<li><div>Black</div></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>티 높이</dt>
				<dd>
					<ul id="select_teeHeight">
						<li><div>35mm</div></li>
						<li><div>40mm</div></li>
						<li><div>45mm</div></li>
						<li><div>50mm</div></li>
						<li><div>55mm</div></li>
						<li><div>60mm</div></li>
						<li><div>65mm</div></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>클럽별 거리</dt>
				<dd>
					<ul id="select_unit">
						<li><div class="active">미터</div></li>
						<li><div>야드</div></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>&nbsp;</dt>
				<dd>드라이버/우드<br>
					<ul>
						<li>W1<br><input type="number" id="dist_driver" value="{{user.user_clubdist_driver}}"></li>
						<li>W3<input type="number" id="dist_w3" value="{{user.user_clubdist_w3}}"></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>&nbsp;</dt>
				<dd>유틸리티<br>
					<ul>
						<li>U3<input type="number" id="dist_u3" value="{{user.user_clubdist_u3}}"></li>
						<li>U5<input type="number" id="dist_u5" value="{{user.user_clubdist_u5}}"></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>&nbsp;</dt>
				<dd>아이언<br>
					<ul>
						<li>I3<input type="number" id="dist_i3" value="{{user.user_clubdist_i3}}"></li>
						<li>I4<input type="number" id="dist_i4" value="{{user.user_clubdist_i4}}"></li>
						<li>I5<input type="number" id="dist_i5" value="{{user.user_clubdist_i5}}"></li>
						<li>I6<input type="number" id="dist_i6" value="{{user.user_clubdist_i6}}"></li>
						<li>I7<input type="number" id="dist_i7" value="{{user.user_clubdist_i7}}"></li>
						<li>I8<input type="number" id="dist_i8" value="{{user.user_clubdist_i8}}"></li>
						<li>I9<input type="number" id="dist_i9" value="{{user.user_clubdist_i9}}"></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>&nbsp;</dt>
				<dd>웨지<br>
					<ul>
						<li>PW<input type="number" id="dist_pw" value="{{user.user_clubdist_pw}}"></li>
						<li>AW<input type="number" id="dist_aw" value="{{user.user_clubdist_aw}}"></li>
						<li>SW<input type="number" id="dist_sw" value="{{user.user_clubdist_sw}}"></li>
					</ul>
				</dd>
			</dl>
		</div>
		<!--게임 설정 정보-->

		<div class="settinInfo wrap1200">설정된 값은 게임에서 반영됩니다.</div>
		<div class="center"><a class="settingSave">게임설정 저장</a></div>

		
		<!--내용끝-->
		</div>
	</article>
	<!--바디-->

	{{>footer}}
	
	<script>
		
		var ctx1 = document.getElementById('chart_score').getContext('2d');
		var purple_orange_gradient = ctx1.createLinearGradient(0, 0, 300, 0);
		purple_orange_gradient.addColorStop(0, '#e8e8ef');
		purple_orange_gradient.addColorStop(1, '#fce5ec');
		var config_score = {
			type: 'line',
			data: {
				labels: ['', '', '', '', '', '', ''],
				datasets: [{
					label: '',
					backgroundColor: purple_orange_gradient,
					borderColor: '#182b6d',
					data: [{{chart1}}],
					fill: 'start',
				}]
			},
			options: {
				legend: {
					display: false
				},
				responsive: true,
				title: {
					display: false,
				},
				tooltips: {
					enabled: false,
					mode: 'index',
					intersect: false,
				},
				hover: {
					animationDuration: 0,
					display: false,
					mode: 'nearest',
					intersect: true
				},
				scales: {
					xAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						}
					}],
					yAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						ticks: {
							reverse: true,
							min: 30,
							max: 120,
						},
					}]
				},
				animation: {
					onComplete: function() {
						var chartInstance = this.chart;
						var ctx = chartInstance.ctx;
						ctx.textAlign = "center";
						ctx.font = "14px Roboto";
						ctx.fillStyle = "#182b6d";

						Chart.helpers.each(this.data.datasets.forEach(function(dataset, i) {
							var meta = chartInstance.controller.getDatasetMeta(i);
							Chart.helpers.each(meta.data.forEach(function(bar, index) {
								if (index == meta.data.length - 1) {
									ctx.fillStyle = "#ff2b6d";
								} else {
									ctx.fillStyle = "#182b6d";
								}
								var data = dataset.data[index];
								var barWidth = bar._model.x - bar._model.base;
								//var centerX = bar._model.base + barWidth / 2;
								var centerX = bar._model.x;
								if (i == 0) {
									ctx.fillText(data, centerX - 10, bar._model.y - 12);
								} else {
									ctx.fillText(data, centerX, bar._model.y - 12);
								}
							}), this);
						}), this);
					}
				},
			}
		};
		window.onload = function() {
			window.myChart1 = new Chart(ctx1, config_score);
		};
		$(document).ready(function() {
			$('.gameSetting dd ul div').click(function(e) {
				var li = $(this).parent().siblings();
				li.children('div').removeClass('active');
				$(this).addClass('active');
			})
			$('#select_difficulty li').eq({{user.user_setDifficulty}}).find('div').addClass('active');
			var tasekPos = {{user.user_setTasekPos}} ? 0 : 1;
			$('#select_tasekPos li').eq(tasekPos).find('div').addClass('active');
			$('#select_teePos li').eq({{user.user_setTeePos}}).find('div').addClass('active');
			$('#select_teeHeight li').eq({{user.user_setTeeHeight}}).find('div').addClass('active');
			//$('#select_unit li').eq({{user.user_setDifficulty}}).find('div').addClass('active');

			$('.settingSave').click(function(e) {
				const api_url = "{{user.api_url}}";
				var tasekPos = $('#select_tasekPos li div.active').parent().index() ? 0 : 1;
				var params = {
					access_token: "{{user.access_token}}",
					difficulty: $('#select_difficulty li div.active').parent().index(),
					tasekPos: tasekPos,
					teePos: $('#select_teePos li div.active').parent().index(),
					teeHeight: $('#select_teeHeight li div.active').parent().index(),
					driver: $('#dist_driver').val(),
					w3: $('#dist_w3').val(),
					u3: $('#dist_u3').val(),
					u5: $('#dist_u5').val(),
					i3: $('#dist_i3').val(),
					i4: $('#dist_i4').val(),
					i5: $('#dist_i5').val(),
					i6: $('#dist_i6').val(),
					i7: $('#dist_i7').val(),
					i8: $('#dist_i8').val(),
					i9: $('#dist_i9').val(),
					pw: $('#dist_pw').val(),
					aw: $('#dist_aw').val(),
					sw: $('#dist_sw').val(),
				}
				$.post(api_url + 'api/Accounts/update-gamesetting', params, function(result) {
					if (result.res.success) {
						alert('성공적으로 보관되였습니다.');
						window.location.href = '/';
					} else {
						alert(result.res.result);
					}
				});
			})
		})
	</script>
	</body>
</html>
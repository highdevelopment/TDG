<!doctype html>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=1200, initial-scale=1.0, maxium-scale=1.0, minimum-scale=1.0, user-scalable=yes" />
		<meta name="format-detection" content="telephone=no" />
		<!-- Favicon -->
		<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
		<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
		<link rel="stylesheet" href="../style/css/reset.css" media="all">
		<title>더 도어스 스크린 골프 내 기록 분석</title>
		<!--[if lt IE 9]>
			<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js" type="text/javascript"></script>
			<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/ie7-squish.js" type="text/javascript"></script>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
		<script type="text/javascript" src="../style/js/jquery-1.11.3.min.js"></script>
		<script type="text/javascript" src="../style/js/jquery.bxslider/jquery.bxslider.min.js"></script>
		<script type="text/javascript" src="../style/js/main.js"></script>
		<script type="text/javascript" src="../style/js/Chart.min.js"></script>
		<style>
		canvas{
			-moz-user-select: none;
			-webkit-user-select: none;
			-ms-user-select: none;
		}
		</style>
	</head>
	<body>

	<!--헤더-->
	{{>header}}
	<!--헤더-->


	<!--서브탑-->
	<div class="subTop">
		<div class="subTopInner">
			<h1>내 기록 분석</h1>
			<div class="location">
				<a href="#">MY DOORS</a> > <span>내 기록 분석</span>
			</div>
		</div>
	</div>
	<!--서브탑-->

	<!--바디-->
	<article>
		<div id="bodyWrap">
		<!--내용시작-->


<!--회원 정보-->
<div class="settingTop settingTopW wrap1200">
	<div class="wrap835">
		<figure>
			<img src="{{user.photo}}" alt="">
			<figcaption>{{user.nickname}} 님<span>{{user.username}}</span><span>{{user.user_level}} 등급</span></figcaption>
		</figure>
		<div class="info">
			<p>{{user.nickname}} 프로님, 반갑습니다.</p>
			<ul>
				<li>
					<h3>나의 기록</h3>
					<ul>
						<li>{{user.user_bestscore}}<span>최고 스코어</span></li>
						<li>{{user.user_bestCarry}}m<span>최대 비거리</span></li>
						<li>{{user.user_bestPuttingDist}}m<span>최대 퍼팅거리</span></li>
						<li>{{user.user_averscore}}<span>평균 타수</span></li>
						<li>{{user.user_averCarry}}m<span>평균 비거리</span></li>
						<li>{{user.user_averPuttingNum}}<span>평균 퍼팅수</span></li>
					</ul>
				</li>
				<li>
					<h3>나의 경기력</h3>
					<div style="width:296px; padding-left: 33px;">
						<canvas id="chart_score"></canvas>
					</div>
					{{!-- <img src="../images/mydoors/memberGraph.png" alt="김도어 님 그래프"> --}}
				</li>
			</ul>
		</div>
	</div>
</div>
<!--회원 정보-->

<!--그래프-->
<div class="recordAnalysis wrap1200">
	<div class="wrap800">
		<ul>
			<li>
				<h3>나의 게임능력</h3>
				<div style="padding-top: 50px;">
					<canvas id="chart_power" width="423"></canvas>
				</div>
				{{!-- <img src="../images/mydoors/gameAbilityGraph.png" alt="나의 게임능력"> --}}
			</li>
			<li>
				<h3>기록분석</h3>
					<div>
						<canvas id="chart_analy" height="258"></canvas>
					</div>
				{{!-- <img src="../images/mydoors/recordAnalysisGraph.png" alt="기록분석"> --}}
			</li>
		</ul>
	</div>
</div>
<!--그래프-->

<!--비거리분석-->
<div class="clubAnalysis">
	<h3>클럽별 비거리 분석</h3>
	<!--분석표-->
	<div class="sideL">
		<table>
			<caption></caption>
			<colgroup>
				<col style="">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
				<col style="width:7.6%;">
			</colgroup>
			<thead>
				<tr>
					<th class="roundTL">{{club.0.name}}</th>
					<th>{{club.1.name}}</th>
					<th>{{club.2.name}}</th>
					<th>{{club.3.name}}</th>
					<th>{{club.4.name}}</th>
					<th>{{club.5.name}}</th>
					<th>{{club.6.name}}</th>
					<th>{{club.7.name}}</th>
					<th>{{club.8.name}}</th>
					<th>{{club.9.name}}</th>
					<th>{{club.10.name}}</th>
					<th>{{club.11.name}}</th>
					<th>{{club.12.name}}</th>
					<th class="roundTR">{{club.13.name}}</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td class="roundBL">{{club.0.dist}}</td>
					<td>{{club.1.dist}}</td>
					<td>{{club.2.dist}}</td>
					<td>{{club.3.dist}}</td>
					<td>{{club.4.dist}}</td>
					<td>{{club.5.dist}}</td>
					<td>{{club.6.dist}}</td>
					<td>{{club.7.dist}}</td>
					<td>{{club.8.dist}}</td>
					<td>{{club.9.dist}}</td>
					<td>{{club.10.dist}}</td>
					<td>{{club.11.dist}}</td>
					<td> {{club.12.dist}}</td>
					<td class="roundBR">{{club.13.dist}}</td>
				</tr>
			</tbody>
		</table>
		<br>
		<table>
			<caption></caption>
			<colgroup>
			</colgroup>
			<thead>
				<tr>
					<th class="roundTL"></th>
					{{#each club}}
						<th>{{this.name}}</th>
					{{/each}}
				</tr>
			</thead>
			<tbody>
				<tr>
					<th class="left">입력비거리</th>
					{{#each club}}
						<td>{{this.user_dist}}</td>
					{{/each}}
				</tr>
				<tr>
					<th class="left">거리편차</th>
					{{#each club}}
						{{#if (gt this.delta 0)}}
							<td class="mark">+{{this.delta}}</td>
						{{else if (lt this.delta 0)}}
							<td>-{{this.delta}}</td>
						{{else}}
							<td>{{this.delta}}</td>
						{{/if}}
					{{/each}}
				</tr>
				<tr>
					<th class="left">평균 비거리</th>
					{{#each club}}
						<td>{{this.flyDist}}</td>
					{{/each}}
				</tr>
				<tr>
					<th class="left">평균 런거리</th>
					{{#each club}}
						<td>{{this.runDist}}</td>
					{{/each}}
				</tr>
				<tr>
					<th class="left">평균 발사각</th>
					{{#each club}}
						<td>{{this.launchAngle}}</td>
					{{/each}}
				</tr>
				<tr>
					<th class="left">평균 볼스피드</th>
					{{#each club}}
						<td>{{this.velocity}}</td>
					{{/each}}
				</tr>
			</tbody>
		</table>
	</div>
	<!--분석표-->
	<!--결과-->
	<div class="sideR">
		<p>회원님의 18홀<br>GAME TEST 결과<br><span>73.5 점</span></p>
		<ul >
			<li>DRIVER<span>80</span></li>
			<li>W/U<span>80</span></li>
			<li class="winner_03">LONG IRON<span>80</span><span>3</span></li>
			<li>MIDDLE IRON<span>80</span></li>
			<li class="winner_01">SHORT IRON<span>80</span><span>1</span></li>
			<li class="winner_02">PUTTER<span>80</span><span>2</span></li>
			<li>스코어 가산점<span>6</span></li>
		</ul>
	</div>
	<!--결과-->
</div>
<!--비거리분석-->

<!--게임기록-->
<div class="gameRecord wrap1200">
	<div class="wrap835">
		<!--게임기록탑-->
		<div class="gameRecordTop">
			<h3>게임 기록</h3>
			<!--검색-->
			<div style="display: none;"><input type="text" id="" name="" value="" title="검색어"><input type="submit" value="검색" title="검색"></div>
			<!--검색-->
		</div>
		<!--게임기록탑-->
		<!--목록-->
		<div class="bbsList">
			<table>
				<caption>게임기록 목록</caption>
				<colgroup>
				</colgroup>
				<thead>
					<tr>
						<th>일시</th>
						<th>게임구분</th>
						<th>가맹점</th>
						<th>가맹점 주소</th>
						<th>코스</th>
						<th>홀</th>
						<th>타수(기준)</th>
					</tr>
				</thead>
				<tbody>
					{{#each gameLogs}}
						<tr log_id = "{{this.gameLogId}}">
							<td>{{this.time_yymmdd}}</td>
							<td>{{this.game_mode}}</td>
							<td>{{this.store}}</td>
							<td>{{this.storeAddress}}</td>
							<td>{{this.course_name}}</td>
							<td>{{this.game_holenum}}</td>
							<td style="color: #3b8ccc; font-weight: bold; font-size: 18px;">{{this.score}} <span class="tspan">({{this.handicap}})</span></td>
						</tr>
					{{/each}}
				</tbody>
			</table>
		 </div>
		 <!--목록-->
		 <!--페이징-->
		<div class="paging">
			<a href="?page={{page.prevPage10}}" class="prev10 {{page.prev10_disable}}">이전10</a>
			<a href="?page={{page.prevPage}}" class="prev {{page.prev_disable}}">이전</a>
			{{#for page.start page.end 1}}
				{{#if (eq @root.page.pageIndex this)}}
					<a href="?page={{this}}" class="on">{{math this "+" 1}}</a>
				{{else}}
					<a href="?page={{this}}" class="">{{math this "+" 1}}</a>
				{{/if}}
			{{/for}}
			<a href="?page={{page.nextPage}}" class="next {{page.next_disable}}">다음</a>
			<a href="?page={{page.nextPage10}}" class="next10 {{page.next10_disable}}">다음10</a>
		</div>
		 <!--페이징-->
		</div>
	</div>
	<!--게임기록-->

	<!--게임기록팝업창-->
	<div class="gameRecordPop">
		<div class="inner">
			<ul class="gameRecordPopSlide">
				{{#each gameLogs}}
					<li>
						<div class="gameRecordPopCon">
							<h4 style="float:left">{{this.course_name}}</h4>&nbsp;&nbsp;
							<label style="font-size: 20px;padding: 15px;">2018.4.14</label>
							<span>{{this.score}}</span>
							<h5>인코스</h5>
							<table>
									<tr>
									{{#each this.score_details.scores1}}
										<th>{{math @index "+" 1}}</th>
									{{/each}}
										<th rowspan="2" class="bigOne">{{this.score_details.sub1_par_sum}}</th>
									</tr>
									<tr>
									{{#each this.score_details.scores1}}
										<td>{{this}}</td>
									{{/each}}
									</tr>
							</table>
							<h5>아웃코스</h5>
							<table>
									<tr>
									{{#each this.score_details.scores2}}
										<th>{{math @index "+" 1}}</th>
									{{/each}}
										<th rowspan="2" class="bigOne">{{this.score_details.sub2_par_sum}}</th>
									</tr>
									<tr>
									{{#each this.score_details.scores2}}
										<td>{{this}}</td>
									{{/each}}
									</tr>
							</table>
						</div>
					</li>
				{{/each}}
			</ul>
			<a class="moreScoreCard" disabled>스코어카드 더 보기</a>
			<a class="closeGameRecordPop">닫기</a>
		</div>
	</div>
	<!--게임기록팝업창-->

		
		<!--내용끝-->
		</div>
	</article>
	<!--바디-->

	{{>footer}}
	
	<script>
		var ctx1 = document.getElementById('chart_score').getContext('2d');
		var purple_orange_gradient = ctx1.createLinearGradient(0, 0, 300, 0);
		purple_orange_gradient.addColorStop(0, '#e8e8ef');
		purple_orange_gradient.addColorStop(1, '#fce5ec');
		var config_score = {
			type: 'line',
			data: {
				labels: ['', '', '', '', '', '', ''],
				datasets: [{
					label: '',
					backgroundColor: purple_orange_gradient,
					borderColor: '#182b6d',
					data: [{{chart1}}],
					fill: 'start',
				}]
			},
			options: {
				legend: {
					display: false
				},
				responsive: true,
				title: {
					display: false,
				},
				tooltips: {
					enabled: false,
					mode: 'index',
					intersect: false,
				},
				hover: {
					animationDuration: 0,
					display: false,
					mode: 'nearest',
					intersect: true
				},
				scales: {
					xAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						}
					}],
					yAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						ticks: {
							reverse: true,
							min: 30,
							max: 120,
						},
					}]
				},
				animation: {
					onComplete: function() {
						var chartInstance = this.chart;
						var ctx = chartInstance.ctx;
						ctx.textAlign = "center";
						ctx.font = "14px Roboto";
						ctx.fillStyle = "#182b6d";

						Chart.helpers.each(this.data.datasets.forEach(function(dataset, i) {
							var meta = chartInstance.controller.getDatasetMeta(i);
							Chart.helpers.each(meta.data.forEach(function(bar, index) {
								if (index == meta.data.length - 1) {
									ctx.fillStyle = "#ff2b6d";
								} else {
									ctx.fillStyle = "#182b6d";
								}
								var data = dataset.data[index];
								var barWidth = bar._model.x - bar._model.base;
								//var centerX = bar._model.base + barWidth / 2;
								var centerX = bar._model.x;
								if (i == 0) {
									ctx.fillText(data, centerX - 10, bar._model.y - 12);
								} else {
									ctx.fillText(data, centerX, bar._model.y - 12);
								}
							}), this);
						}), this);
					}
				},
			}
		};

		var config_power = {
			type: 'bar',
			data: {
				labels: ['평균타수', '평균비거리', '평균퍼팅수', '패어웨이\n안착률', '그린적중률'],
				datasets: [{
					label: '',
					backgroundColor: ['#868686', '#e9e9e9', '#181e63', '#b8b8b8', '#e30046'],
					borderColor: '#00000000',
					data: [
						{{chart.user_averscore}},
						{{chart.user_averCarry}},
						{{chart.user_averPuttingNum}},
						{{chart.user_fairwayHitRate}},
						{{chart.user_greenHitRate}},
					],
				}]
			},
			options: {
				legend: {
					display: false
				},
				responsive: false,
				title: {
					display: false,
					text: ''
				},
				tooltips: {
					enabled: false,
					mode: 'index',
					intersect: false,
				},
				hover: {
					animationDuration: 0,
					display: false,
					mode: 'nearest',
					intersect: true
				},
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						gridLines: {
							color: "rgba(0, 0, 0, 0)",
						}
					}],
					yAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						ticks: {
							min: 0,
							steps: 10,
							reverse: false,
						},
						gridLines: {
							color: "rgba(0, 0, 0, 0)",
						}
					}]
				},
				animation: {
					onComplete: function() {
						var chartInstance = this.chart;
						var ctx = chartInstance.ctx;
						ctx.textAlign = "center";
						ctx.font = "20px roboto";
						ctx.fillStyle = "#fff";

						Chart.helpers.each(this.data.datasets.forEach(function(dataset, i) {
							var meta = chartInstance.controller.getDatasetMeta(i);
							Chart.helpers.each(meta.data.forEach(function(bar, index) {
							var data = dataset.data[index].toFixed(0);
							var barWidth = bar._model.x - bar._model.base;
							//var centerX = bar._model.base + barWidth / 2;
							var centerX = bar._model.x;
							if (i == 0) {
								ctx.fillText(data, centerX, bar._model.y + 23);
							} else {
								ctx.fillText(data, centerX, bar._model.y + 23);
							}
							}), this);
						}), this);
					}
				},
				pointLabelFontFamily: "Quadon Extra Bold",
				scaleFontFamily: "Quadon Extra Bold"
			},
			plugins: [{
				beforeInit: function(chart) {
					chart.data.labels.forEach(function(e, i, a) {
						if (/\n/.test(e)) {
						a[i] = e.split(/\n/);
						}
					});
				}
			}]
		};

		var config_analy = {
			type: 'radar',
			data: {
				labels: ['패어웨이 적중률', '그린\n안착률', '파\n세이브률', '퍼팅 수', '타수', '드라이버\n비거리'],
				datasets: [{
					label: '',
					backgroundColor: ['#393e72'],
					borderColor: 'rgb(0, 0, 0, 0)',
					data: [
						{{chart.user_fairwayHitRate}},
						{{chart.user_greenHitRate}},
						{{chart.user_parSaveRate}},
						{{chart.user_averPuttingNum}},
						{{chart.user_averscore}},
						{{chart.user_averCarry}}
					],
					fill: true,
				}]
			},
			options: {
				layout: {
					padding: {
						left: 0,
						right: 0,
						top: 10,
						bottom: 0
					}
				},
				legend: {
					display: false
				},
				responsive: true,
				title: {
					display: false,
					text: ''
				},
				tooltips: {
					enabled: false,
					mode: 'index',
					intersect: false,
				},
				hover: {
					mode: 'nearest',
					intersect: true
				},
				scale: {
					ticks: {
						display: false,
						beginAtZero: true,
						min: 0,
						userCallback: function(label, index, labels) {
							// when the floored value is the same as the value we have a whole number
							if (Math.floor(label) === label) {
								return label;
							}
						},
					}
				}
			},
			plugins: [{
				beforeInit: function(chart) {
					chart.data.labels.forEach(function(e, i, a) {
						if (/\n/.test(e)) {
						a[i] = e.split(/\n/);
						}
					});
				}
			}]
		};

		window.onload = function() {
			window.myChart1 = new Chart(ctx1, config_score);
			var ctx2 = document.getElementById('chart_power').getContext('2d');
			window.myChart2 = new Chart(ctx2, config_power);
			var ctx3 = document.getElementById('chart_analy').getContext('2d');
			window.myChart3 = new Chart(ctx3, config_analy);
		};

		$(document).ready(function() {
			// gameRecordPopSlide 슬라이드 //
			var slide_option = {
				mode: 'horizontal'	// 가로 방향 수평 슬라이드
				, auto: false        // 자동 실행 여부
				, speed: 800        // 이동 속도를 설정 1000 -> 1초
				, pause: 6000	// 각각의 페이지 로딩 속도 1000 -> 1초
				, autoDelay: 6000		// 페이지 로딩 후 자동스타트 딜레이 초
				, moveSlides: 1     // 슬라이드 이동시 개수
				, slideWidth: 510   // 슬라이드 너비
				, adaptiveHeight: true	//이미지자동높이조절
				, minSlides: 1      // 최소 노출 개수
				, maxSlides: 2      // 최대 노출 개수
				, moveSlides: 1		// 한번이동갯수
				, slideMargin: 20    // 슬라이드간의 간격
				, autoHover: false   // 마우스 호버시 정지 여부
				, controls: true    // 이전 다음 버튼 노출 여부
				, autoControls: false // 플레이이스톱버튼 노출여부
				, pager: false      // 현재 위치 페이징 표시 여부 설정
				, responsive : true //슬라이더의 자동크기조정
				//, ticker: true	// 계속 흐르기
				//, speed: 6000	// 계속 흐르기 속도
			}
			var gameRecordPopSlide = $('.gameRecordPopSlide').bxSlider(slide_option);
			// gameRecordPopSlide 슬라이드 //
			$('.gameRecordPop').hide();
			$('div.bbsList table > tbody > tr').click(function(e) {
				var log_id = $(e.currentTarget).attr('log_id');
				$('.gameRecordPop').show();
				slide_option.startSlide = $(this).index();
				gameRecordPopSlide.reloadSlider(slide_option);
			})
			$('.closeGameRecordPop').click(function() {
				$('.gameRecordPop').hide();
			})
		})
	</script>

	</body>
</html>